<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="/images/LOGO [ajanta R].jpeg.jpg">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

  <!-- Bootstrap CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href="css/product-details.css" rel="stylesheet">
  <title>Product Details - Akshar Enterprise</title>

</head>

<body>
  <!-- Start Header/Navigation -->
  <nav class="custom-navbar navbar navbar-expand-md navbar-dark bg-dark" aria-label="Furni navigation bar">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <div class="logo-rect">
          <img src="images/LOGO [ajanta R].jpeg.jpg" alt="Akshar Enterprise Logo" />
        </div>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsFurni">
        <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="active"><a class="nav-link" href="shop.html">Products</a></li>
          <li><a class="nav-link" href="about.html">About us</a></li>
          <li><a class="nav-link" href="contact.html">Contact us</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- End Header/Navigation -->

  <!-- Breadcrumb Section -->
  <div class="breadcrumb-section">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Home</a></li>
          <li class="breadcrumb-item"><a href="shop.html">Products</a></li>
          <li class="breadcrumb-item active" aria-current="page" id="breadcrumb-product">Product Details</li>
        </ol>
      </nav>
    </div>
  </div>

  <!-- Start Product Details Section -->
  <div class="untree_co-section product-section before-footer-section">
    <div class="container">
      <div class="row" id="product-details">
        <!-- Product details will be dynamically loaded here -->
      </div>
    </div>
  </div>
  <!-- End Product Details Section -->

  <!-- Start Related Products Section -->
  <div class="product-section related-products-section">
    <div class="container">
      <div class="row">
        <div class="col-12 mb-4">
          <div class="d-flex justify-content-center align-items-center" style="width: 100%;">
            <h2 class="section-title text-center" style="font-size:2.5rem; font-weight:700; letter-spacing:1px; margin-bottom: 0;">
              Related Products
            </h2>
          </div>
        </div>
        <div class="col-12" id="related-products-wrapper">
          <!-- Related products will be populated dynamically -->
        </div>
      </div>
    </div>
  </div>
  <!-- End Related Products Section -->

 <!-- Start Footer Section -->
		<footer class="footer-section">
			<div class="container relative">

				

				<div class="row">
					<div class="col-lg-8 d-flex align-items-center justify-content-start mb-4">
						<img src="images/LOGO [ajanta R].jpeg.jpg" alt="Akshar Enterprise Logo" style="max-height: 80px; width: auto;">
					</div>
				</div>

				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">Akshar Enterprise 	<span>.</span></a></div>
						<p class="mb-4">Akshar Enterprise Rajkot is a leading manufacturer
										of high-quality tools and equipment for the construction 
										and tile installation industries. Based in Rajkot, India, 
										the company has been serving customers for over a decade.

						</p>

						
						<ul class="list-unstyled custom-social">
							<li><a href="https://www.instagram.com/superajanta_/"><span class="fa fa-brands fa-facebook-f"></span></a></li>
							<!-- <li><a href="#"><span class="fa fa-brands fa-twitter"></span></a></li> -->
							<li><a href="https://www.instagram.com/superajanta_/"><span class="fa fa-brands fa-instagram"></span></a></li>
							<!-- <li><a href="#"><span class="fa fa-brands fa-linkedin"></span></a></li> -->
						</ul>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">About us</a></li>
									<li><a href="#">Services</a></li>
									<li><a href="#">Blog</a></li>
									<li><a href="#">Contact us</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Tile Adhesive</a></li>
									<li><a href="#">Tile Spacer</a></li>
									<li><a href="#">Notched Trowel</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Wall Putty</a></li>
									<li><a href="#">Waterproffing</a></li>
									<li><a href="#">Epoxy Grout</a></li>
									<li><a href="#">Hardner</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Jack Levellar</a></li>
									<li><a href="#">Hammar</a></li>
									<li><a href="#">Liftter</a></li>
								</ul>
							</div>
						</div>
					</div>

				</div>

				<div class="border-top copyright">
							<p class="mb-2 text-center text-lg-start">Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash;  Akshar Enterprise<!-- License information: https://untree.co/license/ -->
			</p>
							
						</div>

						

					</div>
				</div>

			</div>
		</footer>
		<!-- End Footer Section -->	

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/product-details.js"></script>

  <script>
    // Function to read XLSX file and parse data
    function readXlsxFile(file, callback) {
      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(sheet);
        callback(jsonData);
      };
      reader.readAsArrayBuffer(file);
    }

    // Function to decode product name from URL
    function decodeProductName(encodedName) {
      return decodeURIComponent(encodedName).replace(/-/g, ' ');
    }

    // Function to parse JSON strings safely
    function safeJSONParse(str) {
      try {
        return typeof str === 'string' ? JSON.parse(str) : null;
      } catch (e) {
        return null;
      }
    }

    // Function to render specifications
    function renderSpecifications(specifications) {
      if (!specifications) return '';
      
      const specs = safeJSONParse(specifications);
      if (!specs || !Array.isArray(specs) || specs.length === 0) return '';
      
      const specsHTML = specs.map(spec => `
        <div class="spec-item">
          <div class="spec-key">${spec.key || 'N/A'}</div>
          <div class="spec-value">${spec.value || ''}</div>
        </div>
      `).join('');
      
      return `
        <div class="product-info-section">
          <h4 class="section-title">
            <i class="fas fa-cogs"></i>
            Specifications
          </h4>
          <div class="specs-grid">
            ${specsHTML}
          </div>
        </div>
      `;
    }

    // Function to render features
    function renderFeatures(features) {
      if (!features) return '';
      
      const featuresArray = safeJSONParse(features);
      if (!featuresArray || !Array.isArray(featuresArray) || featuresArray.length === 0) return '';
      
      const featuresHTML = featuresArray.map(feature => `
        <li>${feature}</li>
      `).join('');
      
      return `
        <div class="product-info-section">
          <h4 class="section-title">
            <i class="fas fa-star"></i>
            Key Features
          </h4>
          <ul class="features-list">
            ${featuresHTML}
          </ul>
        </div>
      `;
    }

    // Function to render applications
    function renderApplications(applications) {
      if (!applications) return '';
      
      const applicationsArray = safeJSONParse(applications);
      if (!applicationsArray || !Array.isArray(applicationsArray) || applicationsArray.length === 0) return '';
      
      const applicationsHTML = applicationsArray.map(application => `
        <li>${application}</li>
      `).join('');
      
      return `
        <div class="product-info-section">
          <h4 class="section-title">
            <i class="fas fa-wrench"></i>
            Applications
          </h4>
          <ul class="applications-list">
            ${applicationsHTML}
          </ul>
        </div>
      `;
    }

    // Function to render product details
    function renderProductDetails(product) {
      const productDetails = document.getElementById('product-details');
      
      if (!product) {
        productDetails.innerHTML = `
          <div class="col-12">
            <div class="product-not-found">
              <h3><i class="fas fa-exclamation-triangle"></i> Product Not Found</h3>
              <p>Sorry, the product you are looking for does not exist or may have been removed.</p>
              <a href="shop.html" class="btn btn-primary">
                <i class="fas fa-arrow-left"></i> Back to Products
              </a>
            </div>
          </div>
        `;
        return;
      }

      // Update breadcrumb
      document.getElementById('breadcrumb-product').textContent = product['Product Name'] || 'Product Details';

      const productHTML = `
        <div class="col-12 col-lg-6 mb-5">
          <div class="product-image-container">
            <img src="${product['Image'] || 'images/default-product.png'}" 
                 class="img-fluid product-thumbnail" 
                 alt="${product['Product Name']}"
                 onerror="this.src='images/default-product.png'">
          </div>
        </div>
        <div class="col-12 col-lg-6">
          <h1 class="product-title">${product['Product Name'] || 'Unnamed Product'}</h1>
          
          <div class="product-category">
            <i class="fas fa-tag"></i> ${product['Category'] || 'Uncategorized'}
          </div>
          
          <p class="product-price">
            <i class="fas fa-rupee-sign"></i> ${product['Price'] ? product['Price'].toLocaleString('en-IN') : 'Price on Request'}
          </p>
          
          <div class="product-info-section">
            <h4 class="section-title">
              <i class="fas fa-info-circle"></i>
              Description
            </h4>
            <p>${product['Description'] || 'No description available.'}</p>
          </div>
          
          <div class="d-flex flex-wrap gap-3 mt-4">
            <a href="shop.html" class="btn back-button">
              <i class="fas fa-arrow-left"></i> Back to Products
            </a>
            <a href="#"
               onclick="sendEnquiry('${product['Product Name']}', '${product['Description'] || ''}', '${product['Image'] || 'images/default-product.png'}', '${product['Price'] || 'N/A'}')"
               class="btn enquiry-button">
              <i class="fas fa-phone"></i> Enquire Now
            </a>
          </div>
        </div>
        
        <div class="col-12 mt-5">
          ${renderSpecifications(product['Specifications'])}
          ${renderFeatures(product['Features'])}
          ${renderApplications(product['Applications'])}
        </div>
      `;
      
      productDetails.innerHTML = productHTML;
    }

    // Function to render related products in a fixed grid of 4 per row
    function renderRelatedProducts(products, currentProductName) {
      const wrapper = document.getElementById('related-products-wrapper');
      wrapper.innerHTML = '';

      // Find the current product's category
      const currentProduct = products.find(p => 
        p['Product Name']?.toString().trim().toLowerCase() === currentProductName.toLowerCase()
      );
      const currentCategory = currentProduct?.['Category']?.toString().trim();

      if (!currentCategory) {
        wrapper.innerHTML = '<p>No related products available.</p>';
        return;
      }

      // Filter related products (same category, exclude current product)
      const relatedProducts = products.filter(product => 
        product['Category']?.toString().trim().toLowerCase() === currentCategory.toLowerCase() &&
        product['Product Name']?.toString().trim().toLowerCase() !== currentProductName.toLowerCase()
      );

      if (relatedProducts.length === 0) {
        wrapper.innerHTML = '<p>No related products available in this category.</p>';
        return;
      }

      // Group products into rows of 4
      const rows = [];
      for (let i = 0; i < relatedProducts.length; i += 4) {
        rows.push(relatedProducts.slice(i, i + 4));
      }

      // Create rows for each group of 4 products
      rows.forEach(row => {
        const rowDiv = document.createElement('div');
        rowDiv.className = 'row mb-4';

        row.forEach(product => {
          const colDiv = document.createElement('div');
          colDiv.className = 'col-12 col-md-3';

          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          productCard.setAttribute('data-description', product['Description'] || 'No description available.');
          productCard.setAttribute('data-image', product['Image'] || '');

          const imageSrc = product['Image'] || 'https://via.placeholder.com/300x200?text=No+Image';
          const productName = product['Product Name'] || 'Unknown Product';
          const productPrice = product['Price'] ? `‚Çπ${parseFloat(product['Price']).toFixed(2)}` : 'Price not available';
          const productDescription = product['Description'] || 'No description available.';
          productCard.innerHTML = `
            <a class="product-item" href="product-details.html?name=${encodeURIComponent(productName.replace(/\s+/g, '-'))}">
              <img src="${imageSrc}" class="img-fluid product-thumbnail" alt="${productName}">
              <h3 class="product-title">${productName}</h3>
              <p class="product-description" style="font-size:0.95rem; color:#555; min-height:2.5em; margin-bottom:10px; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">
                ${productDescription}
              </p>
              <strong class="product-price">${productPrice}</strong>
              <div class="d-flex justify-content-center align-items-center flex-column">
                <a href="#" class="btn btn-primary enquire-btn">Enquire Now</a>
              </div>
            </a>
          `;

          colDiv.appendChild(productCard);
          rowDiv.appendChild(colDiv);
        });

        wrapper.appendChild(rowDiv);
      });
    }

    // WhatsApp Enquiry Button
   // Modified WhatsApp enquiry function
function sendEnquiry(name, description, imagePath, price) {
  const phone = "9662790002"; // Your WhatsApp number
  const website = window.location.origin;
  const imageURL = imagePath.startsWith('http') ? imagePath : `${website}/${imagePath}`;
  
  const message = `üì¶ *Product Enquiry*\n\n` +
                 `üõçÔ∏è *Name:* ${name}\n` +
                 `üìù *Description:* ${description || 'N/A'}\n` +
                 `üí∞ *Price:* ‚Çπ${price}\n` +
                 `üñºÔ∏è *Image:* ${imageURL}\n\n` +
                 `I'd like to know more about this product.`;
  
  const encodedMessage = encodeURIComponent(message);
  const waLink = `https://wa.me/${phone}?text=${encodedMessage}`;
  window.open(waLink, '_blank');
}

    // Load product details and related products from XLSX
    document.addEventListener('DOMContentLoaded', function () {
      // Get product name from URL
      const urlParams = new URLSearchParams(window.location.search);
      const productName = decodeProductName(urlParams.get('name') || '');

      if (!productName) {
        renderProductDetails(null);
        renderRelatedProducts([], '');
        return;
      }

      // Show loading state
      document.getElementById('product-details').innerHTML = `
        <div class="col-12 text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3">Loading product details...</p>
        </div>
      `;
      document.getElementById('related-products-wrapper').innerHTML = `
        <div class="col-12 text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3">Loading related products...</p>
        </div>
      `;

      // Load products.xlsx
      fetch('products.xlsx')
        .then(response => {
          if (!response.ok) {
            throw new Error('Failed to load product data');
          }
          return response.blob();
        })
        .then(blob => {
          readXlsxFile(blob, function (products) {
            // Find the product by name (case-insensitive)
            const product = products.find(p => 
              p['Product Name']?.toString().trim().toLowerCase() === productName.toLowerCase()
            );
            renderProductDetails(product);
            renderRelatedProducts(products, productName);

            // Attach event listeners for enquire buttons
            document.querySelectorAll('.enquire-btn').forEach(button => {
              button.addEventListener('click', function(e) {
                e.preventDefault();
                const card = this.closest('.product-card');
                const name = card.querySelector('.product-title').innerText.trim();
                const price = card.querySelector('.product-price').innerText.replace('‚Çπ', '').trim();
                const description = card.getAttribute('data-description') || 'No description available.';
                const imageURL = card.getAttribute('data-image') || 'images/default-product.png';
                sendEnquiry(name, description, imageURL, price);
              });
            });
          });
        })
        .catch(error => {
          console.error('Error loading products.xlsx:', error);
          document.getElementById('product-details').innerHTML = `
            <div class="col-12">
              <div class="product-not-found">
                <h3><i class="fas fa-exclamation-triangle"></i> Error Loading Product</h3>
                <p>There was an error loading the product data. Please try again later.</p>
                <a href="shop.html" class="btn btn-primary">
                  <i class="fas fa-arrow-left"></i> Back to Products
                </a>
              </div>
            </div>
          `;
          document.getElementById('related-products-wrapper').innerHTML = '<p>Error loading related products.</p>';
        });
    });
  </script>
</body>
</html>